<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>bucles_loops.knit</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/clipboard-2.0.6/clipboard.min.js"></script>
<link href="site_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.css" rel="stylesheet" />
<script src="site_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.js"></script>
<script>window.xaringanExtraClipboard(null, {"button":"<i class=\"fa fa-clipboard\"><\/i>","success":"<i class=\"fa fa-check\" style=\"color: #90BE6D\"><\/i>","error":"<i class=\"fa fa-times-circle\" style=\"color: #F94144\"><\/i>"})</script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="extra.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R avanzado</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Manuales
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="fundamentos_de_r.html">Fundamentos de R</a>
    </li>
    <li>
      <a href="reportes_dinamicos_con_rmarkdown.html">Reportes dinámicos con Rmarkdown</a>
    </li>
    <li>
      <a href="funciones.html">Funciones</a>
    </li>
    <li>
      <a href="bucles_loops.html">Bucles</a>
    </li>
    <li>
      <a href="modelos_de_regresion_lineal.html">Modelos de regresión lineal</a>
    </li>
    <li>
      <a href="stadistica_tradicional_en_regresiones.html">Modelos comunes como regresiones</a>
    </li>
    <li>
      <a href="graficos_con_ggplot2.html">Gráficos con ggplot2</a>
    </li>
  </ul>
</li>
<li>
  <a href="preparacion_curso.html">Preparación para el curso</a>
</li>
<li>
  <a href="https://codefile.io/f/XOIzH23KfULuZKyZ1TYT">Compartir código</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tareas
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="tarea_4.html">Tarea 4</a>
    </li>
    <li>
      <a href="respuestas_tarea_4.html">Solución: tarea 4</a>
    </li>
    <li class="dropdown-header">Tarea 5</li>
  </ul>
</li>
<li>
  <a href="https://github.com/maRce10/ucr_r_avanzado/raw/master/additional_files/2022-08-05_Probl%20Esp%20Ecol_Estadistica%20Avanzada%20en%20R.pdf">Programa del curso</a>
</li>
<li>
  <a href="instructor.html">Instructor</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore"><center>
<font size="7"><b>Bucles (loops)</b></font>
</center></h1>
<h3 class="subtitle"><center>
<font size="5"><b>Programación y métodos estadísticos avanzados en
R</b></font>
</center></h3>
<h4 class="author"><center>
<font size="5"><a href="http://marceloarayasalas.weebly.com/">Marcelo
Araya-Salas, PhD</a></font>
</center></h4>
<h4 class="date"><center>
“2022-10-06”
</center></h4>

</div>


<style>
body
  { counter-reset: source-line 0; }
pre.numberSource code
  { counter-reset: none; }
</style>
<!-- skyblue box -->
<div id="objetivo-del-manual" class="section level1 alert alert-info">
<h1>Objetivo del manual</h1>
<ul>
<li>Aprender a procesar de forma serial operaciones que deben repetirse
sobre diferentes objetos</li>
<li>Familiarizarse con el uso de bucles en la plataforma R</li>
<li>Tener una noción general de los opciones disponibles en R para
construir bucles</li>
</ul>
</div>
<hr />
<p>Primero debemos preparar los archivos de ejemplo:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># definir directorio a donde guardar los archivos</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>directorio <span class="ot">&lt;-</span> <span class="st">&quot;DIRECCION_DONDE_DESEA_GUARDAR_LOS ARCHIVOS_DE_EJEMPLO&quot;</span></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># guardar archivos</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">download.file</span>(<span class="at">url =</span> <span class="st">&quot;https://github.com/maRce10/ucr_r_avanzado/raw/master/additional_files/datos_camara_submarina.zip&quot;</span>,</span>
<span id="cb1-6"><a href="#cb1-6"></a>    <span class="at">destfile =</span> <span class="fu">file.path</span>(directorio, <span class="st">&quot;datos_camara_submarina.zip&quot;</span>))</span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co"># extraerlos del zip</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">unzip</span>(<span class="at">zipfile =</span> <span class="fu">file.path</span>(directorio, <span class="st">&quot;datos_camara_submarina.zip&quot;</span>),</span>
<span id="cb1-10"><a href="#cb1-10"></a>    <span class="at">exdir =</span> directorio)</span>
<span id="cb1-11"><a href="#cb1-11"></a></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co"># hacer vector con nombre y direccion de archivos</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>archivos_txt <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> directorio, <span class="at">full.names =</span> <span class="cn">TRUE</span>, <span class="at">pattern =</span> <span class="st">&quot;TXT$&quot;</span>)</span></code></pre></div>
<p> </p>
<p>Si todo salió bien el vector “archivos_txt” deberia tener 19
elementos:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">length</span>(archivos_txt)</span></code></pre></div>
<pre><code>## [1] 19</code></pre>
<hr />
<p> </p>
<div id="bucles-loops" class="section level1">
<h1>Bucles (loops)</h1>
<ul>
<li>Proceso automatizado de varios pasos organizado como secuencias de
acciones (p. Ej., procesos ‘por lotes’)</li>
<li>Se usa para acelerar los procedimientos en los que se aplica la
misma acción a muchos objetos (similares)</li>
<li>Crítico para la gestión de grandes bases de datos (‘big data’, y
buenas prácticas de programación)</li>
</ul>
<p>2 tipos básicos:</p>
<ol style="list-style-type: decimal">
<li>Ejecutar para un número predefinido de iteraciones (es decir,
tiempos). Estos se subdividen en dos clases:
<ol style="list-style-type: lower-alpha">
<li>Los resultados pueden ingresarse nuevamente en la siguiente
iteración (bucles <code>for</code>)</li>
<li>Los resultados de una interacción no pueden afectar a otras
iteraciones (<code>(X)apply</code>)</li>
</ol></li>
</ol>
<p><img src="images/loops2_esp.png" width="70%" style="display: block; margin: auto;" />
 </p>
<p><font size = "2"> * Modificado de <i> Tutorial de bucles Datacamp
</i> </font></p>
<p> </p>
<ol start="2" style="list-style-type: decimal">
<li>Ejecutar hasta que se cumpla una condición predefinida (bucles
<code>while</code> y<code>repeat</code>)</li>
</ol>
<p><img src="images/loops1_esp.png" width="70%" style="display: block; margin: auto;" /></p>
<p> </p>
<hr />
</div>
<div id="bucles-for" class="section level1">
<h1>Bucles ‘for’</h1>
<p>Por mucho, <code>for</code> es el bucle más popular. Se caracteriza
por que el número de iteraciones se puede determinar de antemano y las
iteraciones pueden tomar en cuenta resultados de iteraciones
anteriores:</p>
<p><img src="images/for_esp.png" width="40%" style="display: block; margin: auto;" />
 </p>
<p>El bucle <code>for</code> se inicia con el operador <code>for</code>.
A este se le da un vector (<em>sensu lato</em>: lista o vector atómico)
sobre el cual repetir una tarea. La tarea se encuentra en el cuerpo del
bucle:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>vctr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> <span class="co"># vector sobre el cual iterar el bucle</span></span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="cf">for</span>(i <span class="cf">in</span> vctr) <span class="co"># inicio del bucle</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="fu">print</span>(i<span class="sc">^</span><span class="dv">2</span>) <span class="co"># cuerpo del bucle</span></span></code></pre></div>
<pre><code>## [1] 1
## [1] 4
## [1] 9</code></pre>
<p> </p>
<p>Note que en dentro de los paréntesis del operador <code>for</code> se
usa el operador <code>in</code>. Este denota el nombre de objeto que se
usará en el cuerpo del bucle para asignar los velores del vector. El
bucle devuelve 3 valores, uno para cada valor en <code>vctr</code>.</p>
<p>Si deseamos guardar el resultado de las operaciones debemos añadirlo
a un vector vacío. Para hacer esto hay 2 opciones:</p>
<ul>
<li>Usando la función <code>append()</code></li>
<li>Agregar nuevos elementos a un vector usando indexación</li>
</ul>
<p>El siguiente código guarda los resultados usando
<code>append()</code>:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>vctr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>  <span class="co"># vector sobre el cual iterar el bucle</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>resultados <span class="ot">&lt;-</span> <span class="fu">vector</span>()  <span class="co"># vector vacio</span></span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="cf">for</span> (i <span class="cf">in</span> vctr) {</span>
<span id="cb6-5"><a href="#cb6-5"></a>    <span class="co"># inicio del bucle</span></span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a>    i2 <span class="ot">&lt;-</span> i<span class="sc">^</span><span class="dv">2</span>  <span class="co"># cuerpo del bucle</span></span>
<span id="cb6-8"><a href="#cb6-8"></a></span>
<span id="cb6-9"><a href="#cb6-9"></a>    resultados <span class="ot">&lt;-</span> <span class="fu">append</span>(resultados, i2)  <span class="co"># guardar resultados en vector vacio</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>}</span>
<span id="cb6-11"><a href="#cb6-11"></a></span>
<span id="cb6-12"><a href="#cb6-12"></a>resultados</span></code></pre></div>
<pre><code>## [1] 1 4 9</code></pre>
<p>Note que <code>append()</code> se usa dentro del cuerpo del bucle
luego de hacer los cálculos.</p>
<p>Así podemos guardar los resultados usando indexación:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>vctr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>  <span class="co"># vector sobre el cual iterar el bucle</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>resultados <span class="ot">&lt;-</span> <span class="fu">vector</span>()  <span class="co"># vector vacio</span></span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="cf">for</span> (i <span class="cf">in</span> vctr) {</span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="co"># inicio del bucle</span></span>
<span id="cb8-6"><a href="#cb8-6"></a></span>
<span id="cb8-7"><a href="#cb8-7"></a>    i2 <span class="ot">&lt;-</span> i<span class="sc">^</span><span class="dv">2</span>  <span class="co"># cuerpo del bucle</span></span>
<span id="cb8-8"><a href="#cb8-8"></a></span>
<span id="cb8-9"><a href="#cb8-9"></a>    resultados[<span class="fu">length</span>(resultados) <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> i2  <span class="co"># guardar resultados en vector vacio</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>}</span>
<span id="cb8-11"><a href="#cb8-11"></a></span>
<span id="cb8-12"><a href="#cb8-12"></a>resultados</span></code></pre></div>
<pre><code>## [1] 1 4 9</code></pre>
<p>Estos bucles se pueden correr sobre cualquier vector. Por ejemplo
podemos evaluar para el juego de datos <code>iris</code> el promedio del
largo del sépalo para cada especie de esta forma:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>vctr <span class="ot">&lt;-</span> <span class="fu">unique</span>(iris<span class="sc">$</span>Species)  <span class="co"># vector sobre el cual iterar el bucle</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>resultados <span class="ot">&lt;-</span> <span class="fu">vector</span>()  <span class="co"># vector vacio</span></span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="cf">for</span> (i <span class="cf">in</span> vctr) {</span>
<span id="cb10-5"><a href="#cb10-5"></a>    <span class="co"># inicio del bucle</span></span>
<span id="cb10-6"><a href="#cb10-6"></a></span>
<span id="cb10-7"><a href="#cb10-7"></a>    i2 <span class="ot">&lt;-</span> <span class="fu">max</span>(iris<span class="sc">$</span>Sepal.Length[iris<span class="sc">$</span>Species <span class="sc">==</span> i])  <span class="co"># cuerpo del bucle</span></span>
<span id="cb10-8"><a href="#cb10-8"></a></span>
<span id="cb10-9"><a href="#cb10-9"></a>    resultados <span class="ot">&lt;-</span> <span class="fu">append</span>(resultados, i2)  <span class="co"># guardar resultados en vector vacio</span></span>
<span id="cb10-10"><a href="#cb10-10"></a>}</span>
<span id="cb10-11"><a href="#cb10-11"></a></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="fu">names</span>(resultados) <span class="ot">&lt;-</span> vctr  <span class="co"># añadir nombre de especies</span></span>
<span id="cb10-13"><a href="#cb10-13"></a></span>
<span id="cb10-14"><a href="#cb10-14"></a>resultados</span></code></pre></div>
<pre><code>##     setosa versicolor  virginica 
##        5.8        7.0        7.9</code></pre>
<p> </p>
<div id="aplicación-al-manejo-de-datos" class="section level2">
<h2>Aplicación al manejo de datos</h2>
<p>Usaremos los datos de ejemplo que bajamos al inicio del manual para
demostrar la utilidad del los bucles en el manejo de datos. Estos datos
muestran la salida de un programa de identificación automática de
especies marinas en videos pasivos tomados en la columna de agua. Para
cada video analizado el programa genera un archivo de texto (.TXT) con
una fila para cada especie detectada mas una serie de metadatos
asociados a la detección. Los datos se ven así:</p>
<p><img src="images/datos.png" width="100%" style="display: block; margin: auto;" />
 </p>
<p>Recordemos que los nombres de los archivos .TXT están guardados en un
vector llamado <code>archivos_txt</code>. Podemos leer el primer archivo
(i.e. el primer elemento en <code>archivos_txt</code>) de la siguiente
forma:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>archivo1 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(archivos_txt[<span class="dv">1</span>], <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co"># ver pirmeras 4 filas y 8 columnas</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="fu">head</span>(archivo1[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>])</span></code></pre></div>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Filename
</th>
<th style="text-align:center;">
Frame
</th>
<th style="text-align:center;">
Time..mins.
</th>
<th style="text-align:center;">
Period
</th>
<th style="text-align:center;">
Period.time..mins.
</th>
<th style="text-align:center;">
OpCode
</th>
<th style="text-align:center;">
TapeReader
</th>
<th style="text-align:center;">
Depth
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
GH018767_LcamT3.MP4
</td>
<td style="text-align:center;">
11451
</td>
<td style="text-align:center;">
3.1840
</td>
<td style="text-align:center;">
inicio
</td>
<td style="text-align:center;">
1.5504
</td>
<td style="text-align:center;">
R3-LcamT3-RcamN4_Pelada1_2021-09-24
</td>
<td style="text-align:center;">
Andres
</td>
<td style="text-align:center;">
10
</td>
</tr>
<tr>
<td style="text-align:center;">
GH018767_LcamT3.MP4
</td>
<td style="text-align:center;">
25005
</td>
<td style="text-align:center;">
6.9528
</td>
<td style="text-align:center;">
inicio
</td>
<td style="text-align:center;">
5.3192
</td>
<td style="text-align:center;">
R3-LcamT3-RcamN4_Pelada1_2021-09-24
</td>
<td style="text-align:center;">
Andres
</td>
<td style="text-align:center;">
10
</td>
</tr>
<tr>
<td style="text-align:center;">
GH028767_LcamT3.MP4
</td>
<td style="text-align:center;">
30464
</td>
<td style="text-align:center;">
24.5201
</td>
<td style="text-align:center;">
inicio
</td>
<td style="text-align:center;">
22.8865
</td>
<td style="text-align:center;">
R3-LcamT3-RcamN4_Pelada1_2021-09-24
</td>
<td style="text-align:center;">
Andres
</td>
<td style="text-align:center;">
10
</td>
</tr>
<tr>
<td style="text-align:center;">
GH018767_LcamT3.MP4
</td>
<td style="text-align:center;">
26911
</td>
<td style="text-align:center;">
7.4828
</td>
<td style="text-align:center;">
inicio
</td>
<td style="text-align:center;">
5.8492
</td>
<td style="text-align:center;">
R3-LcamT3-RcamN4_Pelada1_2021-09-24
</td>
<td style="text-align:center;">
Andres
</td>
<td style="text-align:center;">
10
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>Podemos saber cuantas especies se observaron en ese muestreo
simplemente calculado el número de filas en <code>archivo</code>:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">nrow</span>(archivo1)</span></code></pre></div>
<pre><code>## [1] 39</code></pre>
<p> </p>
<p>Ahora, para hacer esto con todos los archivos <strong>no es eficiente
leer cada uno en su propia linea de código</strong> y luego calcular el
número de filas. Al fin de cuentas, todos los códigos serian muy
parecidos, solo cambiaría el nombre del archivo. Es en estos casos que
los bucles son de gran utilidad. En este ejemplo solo debemos incorporar
el código de lectura del archivo y del cálculo del número de filas en el
cuerpo del bucle, usando el nombre de los archivos
(<code>archivos_txt</code>) como el vector sobre el cual iterar el
bucle:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>resultados <span class="ot">&lt;-</span> <span class="fu">vector</span>()  <span class="co"># vector vacio</span></span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="cf">for</span> (i <span class="cf">in</span> archivos_txt) {</span>
<span id="cb15-4"><a href="#cb15-4"></a>    <span class="co"># inicio del bucle</span></span>
<span id="cb15-5"><a href="#cb15-5"></a></span>
<span id="cb15-6"><a href="#cb15-6"></a>    txt <span class="ot">&lt;-</span> <span class="fu">read.table</span>(i, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)  <span class="co"># leer archivo</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>    nrw <span class="ot">&lt;-</span> <span class="fu">nrow</span>(txt)  <span class="co"># calcular numero de filas</span></span>
<span id="cb15-8"><a href="#cb15-8"></a></span>
<span id="cb15-9"><a href="#cb15-9"></a>    resultados <span class="ot">&lt;-</span> <span class="fu">append</span>(resultados, nrw)  <span class="co"># guardar resultados en vector vacio</span></span>
<span id="cb15-10"><a href="#cb15-10"></a>}</span>
<span id="cb15-11"><a href="#cb15-11"></a></span>
<span id="cb15-12"><a href="#cb15-12"></a>resultados</span></code></pre></div>
<pre><code>##  [1] 39  1  2 12 14  9 12  8 32 36 21 12 22 27 29 19  8 12 26</code></pre>
<p> </p>
<p>Podemos ordenar estos resultados fácilmente haciendo un cuadro de
datos (data.frame). Para esto creamos una columna con el nombre del
archivo y otra con el resultado del número de filas:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># organizar en data frame</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>n_filas_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">archivo =</span> <span class="fu">basename</span>(archivos_txt), <span class="at">filas =</span> resultados)</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co"># ver primeras 6 filas</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="fu">head</span>(n_filas_df)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
archivo
</th>
<th style="text-align:center;">
filas
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
2022-09-02_R3-LcamT3-RcamN4_Pel1_2021-09-24_MaxN.TXT
</td>
<td style="text-align:center;">
39
</td>
</tr>
<tr>
<td style="text-align:center;">
2022-09-03_S6-LB13-RB12_PuntaMariaOeste_2022-03-24_MaxN.TXT
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
2022-09-03_T4-LB19-RB18_PuntaMariaOeste_2022-03-24_MaxN.TXT
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
2022-09-04_S1-LB10-RN9_Arco2_2022-07-15_MaxN.TXT
</td>
<td style="text-align:center;">
12
</td>
</tr>
<tr>
<td style="text-align:center;">
2022-09-07_P1-LB12-RB13_Gissler_2022-03-30_MaxN.TXT
</td>
<td style="text-align:center;">
14
</td>
</tr>
<tr>
<td style="text-align:center;">
2022-09-11_P1-LB14-RB13_Risco_2022-03-26_MaxN.TXT
</td>
<td style="text-align:center;">
9
</td>
</tr>
</tbody>
</table>
<div class="alert alert-info">
<p><font size = "5"> Ejercicio 1 </font></p>
<p> </p>
<p>Podemos calcular el número de familias observadas para el primer
archivo que leímos (<code>archivo1</code>) de esta forma:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(archivo1<span class="sc">$</span>Family))</span></code></pre></div>
<pre><code>## [1] 19</code></pre>
<p>1.1 Haga un bucle <code>for</code> que devuelva el número de familias
para cada archivo</p>
<p> </p>
<p>1.2 Cree un cuadro de datos (data frame) que contenga dos columnas,
una para el nombre del archivo y otra para el número de familias</p>
<p> </p>
<p>1.3 Añada una columna al cuadro de datos creado en el ejercicio
anterior indicando la fecha de creación del video (esta información se
encuentra en la columna ‘Date’ de cada archivo de texto). Note que cada
archivo contiene solamente una fecha. Debe usar un bucle
<code>for</code> para extraer esta información de los archivos.</p>
<p> </p>
<p>1.4 Añada una columna al cuadro de datos creado en el ejercicio 1.2
(y modificado en 1.3) indicando la profundidad a la que se grabó el
video. Debe usar un bucle <code>for</code> para extraer esta información
de los archivos.</p>
<p> </p>
<p>Puede usar el siguiente código para convertir profundidad a un vector
numérico:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>n_filas_df<span class="sc">$</span>profundidad <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot; m&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">,&quot;</span>, <span class="st">&quot;.&quot;</span>, n_filas_df<span class="sc">$</span>profundidad))</span></code></pre></div>
<p>1.5 ¿Cuál es la correlación entre el número de especies observadas
(que es igual al número de filas) y la profundidad? (pista:
<code>cor.test()</code>)</p>
<p> </p>
<p>1.6 ¿Cuál es la correlación entre el número de familias y la
profundidad?</p>
<p> </p>
</div>
<p>El bucle <code>for</code> también puede ser usado para juntar todas
los datos de los archivos de texto en un solo cuadro de datos. Esto lo
podemos hacer “rellenando” un cuadro de datos vacío, de forma análoga a
como rellenamos un vector vació anteriormente:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>df_resultados <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()  <span class="co"># vector vacio</span></span>
<span id="cb21-2"><a href="#cb21-2"></a></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="cf">for</span> (i <span class="cf">in</span> archivos_txt) {</span>
<span id="cb21-4"><a href="#cb21-4"></a>    <span class="co"># inicio del bucle</span></span>
<span id="cb21-5"><a href="#cb21-5"></a></span>
<span id="cb21-6"><a href="#cb21-6"></a>    txt <span class="ot">&lt;-</span> <span class="fu">read.table</span>(i, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)  <span class="co"># leer archivo</span></span>
<span id="cb21-7"><a href="#cb21-7"></a></span>
<span id="cb21-8"><a href="#cb21-8"></a>    df_resultados <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_resultados, txt)  <span class="co"># guardar resultados en vector vacio</span></span>
<span id="cb21-9"><a href="#cb21-9"></a>}</span>
<span id="cb21-10"><a href="#cb21-10"></a></span>
<span id="cb21-11"><a href="#cb21-11"></a><span class="fu">nrow</span>(df_resultados) <span class="sc">==</span> <span class="fu">sum</span>(n_filas_df<span class="sc">$</span>filas)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<hr />
</div>
</div>
<div id="bucles-xapply" class="section level1">
<h1>Bucles ‘(X)apply’</h1>
<p><code>(X)apply</code> se refiere en realidad a una familia de
funciones que toman una función como entrada y la aplican a una
secuencia de objetos (vectores <em>sensu lato</em>). Por lo tanto hay
varias funciones <code>(X)apply</code> en R:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">apropos</span>(<span class="st">&quot;apply$&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;apply&quot;      &quot;dendrapply&quot; &quot;eapply&quot;     &quot;kernapply&quot;  &quot;lapply&quot;    
##  [6] &quot;mapply&quot;     &quot;rapply&quot;     &quot;sapply&quot;     &quot;tapply&quot;     &quot;vapply&quot;</code></pre>
<p> </p>
<p>Sin embargo, las más utilizadas son
<code>apply</code>,<code>sapply</code>, <code>lapply</code>
y<code>tapply</code>. Todos siguen la misma lógica:</p>
<p><img src="images/xapply_esp.png" width="40%" style="display: block; margin: auto;" /></p>
<p><code>lapply</code> toma un vector (atómico o de lista), aplica una
función a cada elemento y devuelve una lista:</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">lapply</span>(<span class="at">X =</span> lista_datos, <span class="at">FUN =</span> nrow)</span></code></pre></div>
<p> </p>
<p><code>sapply</code> también toma un vector (atómico o de lista) y
aplica la función a cada elemento, sin embargo, el resultado es un
vector atómico (si es que se puede empaquetar como un vector):</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">sapply</span>(<span class="at">X =</span> lista_datos, <span class="at">FUN =</span> nrow)</span></code></pre></div>
<p> </p>
<p><code>apply</code> aplica una función a cada una de las filas o
columnas de un objeto bidimensional. Por ejemplo, el siguiente código
calcula el promedio para largo y ancho de sépalo en el juego de datos
<code>iris</code>:</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># promedio de largo y ancho de setalo</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="fu">apply</span>(<span class="at">X =</span> iris[, <span class="fu">c</span>(<span class="st">&quot;Sepal.Length&quot;</span>, <span class="st">&quot;Sepal.Width&quot;</span>)], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width 
##       5.8433       3.0573</code></pre>
<p> </p>
<p>Note que el argumento ‘MARGIN’ indica si el calculo se lleva a cabo a
nivel de filas (<code>MARGIN = 1</code>) o columnas
(<code>MARGIN = 2</code>).</p>
<p><code>tapply</code> es más específico ya que aplica una función a un
subconjunto de datos definido por un vector categórico adicional. Por
ejemplo, podemos calcular la longitud promedio de pétalo para cada
especie en el juego de datos ‘iris’ de la siguiente manera:</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">tapply</span>(<span class="at">X =</span> iris<span class="sc">$</span>Petal.Length, <span class="at">INDEX =</span> iris<span class="sc">$</span>Species, <span class="at">FUN =</span> mean)</span></code></pre></div>
<pre><code>##     setosa versicolor  virginica 
##      1.462      4.260      5.552</code></pre>
<p> </p>
<p>Los bucles <code>(X)apply</code> pueden modificarse para realizar
acciones personalizadas creando nuevas funciones (ya sea dentro o fuera
del bucle):</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># funcion desde fuera del bucle</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>n_filas <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb31-3"><a href="#cb31-3"></a>    txt <span class="ot">&lt;-</span> <span class="fu">read.table</span>(x, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)  <span class="co"># leer archivo</span></span>
<span id="cb31-4"><a href="#cb31-4"></a>    nrw <span class="ot">&lt;-</span> <span class="fu">nrow</span>(txt)  <span class="co"># calcular numero de filas</span></span>
<span id="cb31-5"><a href="#cb31-5"></a>    <span class="fu">return</span>(nrw)</span>
<span id="cb31-6"><a href="#cb31-6"></a>}</span>
<span id="cb31-7"><a href="#cb31-7"></a></span>
<span id="cb31-8"><a href="#cb31-8"></a><span class="co"># correr bucle</span></span>
<span id="cb31-9"><a href="#cb31-9"></a>filas <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="at">X =</span> archivos_txt, <span class="at">FUN =</span> n_filas)</span>
<span id="cb31-10"><a href="#cb31-10"></a></span>
<span id="cb31-11"><a href="#cb31-11"></a><span class="co"># ver resultados</span></span>
<span id="cb31-12"><a href="#cb31-12"></a><span class="fu">head</span>(filas)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 39
## 
## [[2]]
## [1] 1
## 
## [[3]]
## [1] 2
## 
## [[4]]
## [1] 12
## 
## [[5]]
## [1] 14
## 
## [[6]]
## [1] 9</code></pre>
<p> </p>
<p>Note que el resultado es una lista. Si deseamos generar un vector
podemos usar el bucle <code>sapply</code>:</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># correr bucle</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>filas <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="at">X =</span> archivos_txt, <span class="at">FUN =</span> n_filas)</span>
<span id="cb33-3"><a href="#cb33-3"></a></span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="co"># ver resultados</span></span>
<span id="cb33-5"><a href="#cb33-5"></a><span class="fu">head</span>(filas)</span></code></pre></div>
<pre><code>##        ../2022-09-02_R3-LcamT3-RcamN4_Pel1_2021-09-24_MaxN.TXT 
##                                                             39 
## ../2022-09-03_S6-LB13-RB12_PuntaMariaOeste_2022-03-24_MaxN.TXT 
##                                                              1 
## ../2022-09-03_T4-LB19-RB18_PuntaMariaOeste_2022-03-24_MaxN.TXT 
##                                                              2 
##            ../2022-09-04_S1-LB10-RN9_Arco2_2022-07-15_MaxN.TXT 
##                                                             12 
##         ../2022-09-07_P1-LB12-RB13_Gissler_2022-03-30_MaxN.TXT 
##                                                             14 
##           ../2022-09-11_P1-LB14-RB13_Risco_2022-03-26_MaxN.TXT 
##                                                              9</code></pre>
<p> </p>
<p>Podemos usar funciones anónimas (i.e. funciones que se crean dentro
del llamado del bucle) así:</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># correr bucle</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>filas <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="at">X =</span> archivos_txt, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">nrow</span>(<span class="fu">read.table</span>(x,</span>
<span id="cb35-3"><a href="#cb35-3"></a>    <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)))</span>
<span id="cb35-4"><a href="#cb35-4"></a></span>
<span id="cb35-5"><a href="#cb35-5"></a><span class="co"># ver resultados</span></span>
<span id="cb35-6"><a href="#cb35-6"></a><span class="fu">head</span>(filas)</span></code></pre></div>
<pre><code>##        ../2022-09-02_R3-LcamT3-RcamN4_Pel1_2021-09-24_MaxN.TXT 
##                                                             39 
## ../2022-09-03_S6-LB13-RB12_PuntaMariaOeste_2022-03-24_MaxN.TXT 
##                                                              1 
## ../2022-09-03_T4-LB19-RB18_PuntaMariaOeste_2022-03-24_MaxN.TXT 
##                                                              2 
##            ../2022-09-04_S1-LB10-RN9_Arco2_2022-07-15_MaxN.TXT 
##                                                             12 
##         ../2022-09-07_P1-LB12-RB13_Gissler_2022-03-30_MaxN.TXT 
##                                                             14 
##           ../2022-09-11_P1-LB14-RB13_Risco_2022-03-26_MaxN.TXT 
##                                                              9</code></pre>
<p> </p>
<p>Tenga en cuenta que:</p>
<ol style="list-style-type: decimal">
<li><p>en este tipo de bucles no hay retroalimentación de las
iteraciones anteriores (es decir, los resultados de una iteración no se
pueden ingresar en las iteraciones posteriores)</p></li>
<li><p><code>(X)apply</code> es más limpio que otros bucles porque los
objetos creados dentro de ellos no están disponibles en el entorno de
trabajo actual.</p></li>
</ol>
<p> </p>
<div id="bucles-replicate" class="section level2">
<h2>bucles <code>replicate</code></h2>
<p>El bucle <code>replicate</code> también pertenece a la familia de los
<code>(X)apply</code> (a pesar de su nombre), ya que toma una función y
la replica. Sin embargo solo replica una acción (generalmente aleatoria)
y el usuario no tiene control sobre el insumo a la función. El argumento
‘n’ define cuantas veces se replica la acción y ‘expr’ define la acción
a realizar:</p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">expr =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>))</span></code></pre></div>
<pre><code>##            [,1]      [,2]     [,3]
##  [1,] -1.834208 -1.409215 -1.64309
##  [2,]  0.631061 -0.292518  0.45885
##  [3,]  0.819352 -1.252398  0.73946
##  [4,]  1.560938  0.025473 -0.63085
##  [5,] -0.085904 -1.376017  1.04342
##  [6,]  0.245576  0.358337  0.41443
##  [7,]  0.211755 -0.332801 -1.07307
##  [8,]  0.141935  0.878744 -0.58708
##  [9,] -0.689059 -1.381931 -0.12845
## [10,]  0.702053  0.536120  0.12560</code></pre>
<p> </p>
<p>Note que los resultados son agrupados en una matrix. ‘expr’ también
puede replicar código que no ha sido “empaquetado en una función”.</p>
<p> </p>
<div class="alert alert-info">
<p><font size = "5"> Ejercicio 2</font></p>
<p> </p>
<p>2.1 Haga un bucle <code>lapply</code> equivalente al bucle
<code>for</code> en el ejercicio 1.1.</p>
<p> </p>
<p>2.2 Haga un bucle <code>sapply</code> equivalente al bucle
<code>for</code> en el ejercicio 1.1 y ponga el resultado en un cuadro
de datos, similiar a lo hecho en el ejercicio 1.2</p>
<p> </p>
<p>2.3 Haga un bucle <code>sapply</code> que permita añadir al cuadro de
datos creado en el ejercicio anterior el total de individuos observados
en un muestreo (pista: sumatoria de la columna ‘MaxN’).</p>
<p> </p>
<p>2.3 Haga un bucle <code>apply</code> para calcular el error estandar
para el ancho de sépalo en el juego de datos ‘iris’.</p>
</div>
<hr />
<p> </p>
</div>
</div>
<div id="bucles-repeat" class="section level1">
<h1>Bucles ‘repeat’</h1>
<p>Los bucles <code>repeat</code> deben cumplir una condición para
detenerse. Típicamente el bucle lleva a cabo la acción al menos una vez,
independientemente de la evaluación de la condición:</p>
<p><img src="images/repeat_esp.png" width="40%" style="display: block; margin: auto;" /></p>
<p>El siguiente bucle <code>repeat</code> se ejecuta hasta que la
correlación de las variables continuas generadas al azar es mayor que un
umbral:</p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># crear vector vacio</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>cc_vector <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb39-3"><a href="#cb39-3"></a></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="cf">repeat</span> {</span>
<span id="cb39-5"><a href="#cb39-5"></a>    <span class="co"># generar la variable 1</span></span>
<span id="cb39-6"><a href="#cb39-6"></a>    v1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb39-7"><a href="#cb39-7"></a></span>
<span id="cb39-8"><a href="#cb39-8"></a>    <span class="co"># generar la variable 2</span></span>
<span id="cb39-9"><a href="#cb39-9"></a>    v2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb39-10"><a href="#cb39-10"></a></span>
<span id="cb39-11"><a href="#cb39-11"></a>    <span class="co"># correr la correlacion</span></span>
<span id="cb39-12"><a href="#cb39-12"></a>    corr_coef <span class="ot">&lt;-</span> <span class="fu">cor</span>(v1, v2)</span>
<span id="cb39-13"><a href="#cb39-13"></a></span>
<span id="cb39-14"><a href="#cb39-14"></a>    <span class="co"># guardar resultados</span></span>
<span id="cb39-15"><a href="#cb39-15"></a>    cc_vector[<span class="fu">length</span>(cc_vector) <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> corr_coef</span>
<span id="cb39-16"><a href="#cb39-16"></a></span>
<span id="cb39-17"><a href="#cb39-17"></a>    <span class="co"># parar si se cumple la condicion</span></span>
<span id="cb39-18"><a href="#cb39-18"></a>    <span class="cf">if</span> (corr_coef <span class="sc">&gt;</span> <span class="fl">0.5</span>)</span>
<span id="cb39-19"><a href="#cb39-19"></a>        <span class="cf">break</span></span>
<span id="cb39-20"><a href="#cb39-20"></a></span>
<span id="cb39-21"><a href="#cb39-21"></a>}</span>
<span id="cb39-22"><a href="#cb39-22"></a></span>
<span id="cb39-23"><a href="#cb39-23"></a><span class="fu">head</span>(cc_vector)</span></code></pre></div>
<pre><code>## [1] -0.216263 -0.279111 -0.375114 -0.021205 -0.460309  0.156848</code></pre>
<p> </p>
<p>Podemos graficarlo el resultado asi así:</p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>cc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y =</span> cc_vector, <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cc_vector))</span>
<span id="cb41-2"><a href="#cb41-2"></a></span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cc, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">col =</span> cols[<span class="dv">4</span>],</span>
<span id="cb41-4"><a href="#cb41-4"></a>    <span class="at">lwd =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">col =</span> cols[<span class="dv">8</span>], <span class="at">lwd =</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Iteraciones&quot;</span>,</span>
<span id="cb41-5"><a href="#cb41-5"></a>    <span class="at">y =</span> <span class="st">&quot;Correlación de pearson (r)&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">25</span>)</span></code></pre></div>
<p><img src="bucles_loops_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>La condición determina si el ciclo debe detenerse.</p>
<p>Una característica importante de los bucles
<code>while</code>,<code>repeat</code> y <code>for</code> es que pueden
tomar resultados de iteraciones anteriores como entrada en iteraciones
posteriores. Esto se debe a que los objetos creados dentro de la función
se guardan en el entorno actual (a diferencia de los bucles
<code>Xapply</code>).</p>
<hr />
<p> </p>
</div>
<div id="bucles-while" class="section level1">
<h1>Bucles ‘While’</h1>
<p>Los bucles <code>while</code> aplican una acción en una secuencia de
elementos hasta que se cumpla una condición. Son muy parecidos a los
bucles <code>repeat</code>. La condición puede evaluar un resultado del
propio bucle o una entrada externa:</p>
<p><img src="images/while_esp.png" width="40%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb42"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># definir valor inicial</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>corr_coef <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb42-3"><a href="#cb42-3"></a></span>
<span id="cb42-4"><a href="#cb42-4"></a><span class="co"># iniciar bucle</span></span>
<span id="cb42-5"><a href="#cb42-5"></a><span class="cf">while</span> (corr_coef <span class="sc">&lt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb42-6"><a href="#cb42-6"></a></span>
<span id="cb42-7"><a href="#cb42-7"></a>    <span class="co"># generar la variable 1</span></span>
<span id="cb42-8"><a href="#cb42-8"></a>    v1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb42-9"><a href="#cb42-9"></a></span>
<span id="cb42-10"><a href="#cb42-10"></a>    <span class="co"># generar la variable 2</span></span>
<span id="cb42-11"><a href="#cb42-11"></a>    v2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb42-12"><a href="#cb42-12"></a></span>
<span id="cb42-13"><a href="#cb42-13"></a>    <span class="co"># corrrer la correlacion</span></span>
<span id="cb42-14"><a href="#cb42-14"></a>    corr_coef <span class="ot">&lt;-</span> <span class="fu">cor</span>(v1, v2)</span>
<span id="cb42-15"><a href="#cb42-15"></a></span>
<span id="cb42-16"><a href="#cb42-16"></a>    <span class="co"># imprimir</span></span>
<span id="cb42-17"><a href="#cb42-17"></a>    <span class="fu">print</span>(corr_coef)</span>
<span id="cb42-18"><a href="#cb42-18"></a>}</span>
<span id="cb42-19"><a href="#cb42-19"></a></span>
<span id="cb42-20"><a href="#cb42-20"></a>corr_coef</span></code></pre></div>
<pre><code>##  [1]  0.0872575  0.3865472  0.1199017 -0.2902941  0.2413406 -0.1667497
##  [7]  0.1272541  0.0011283 -0.1344395 -0.0184824  0.5966901</code></pre>
<p> </p>
<p>Con un pequeño ajuste, un bucle <code>while</code> también puede
evaluar varias condiciones a la vez. Por ejemplo, también podemos
incluir altos valores de correlación negativa:</p>
<div class="sourceCode" id="cb44"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co"># definir valor inicial</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>corr_coef <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb44-3"><a href="#cb44-3"></a></span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="co"># crear vector vacio</span></span>
<span id="cb44-5"><a href="#cb44-5"></a>cc_vector <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb44-6"><a href="#cb44-6"></a></span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="cf">while</span> (corr_coef <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">&amp;</span> corr_coef <span class="sc">&gt;</span> <span class="sc">-</span><span class="fl">0.5</span>) {</span>
<span id="cb44-8"><a href="#cb44-8"></a></span>
<span id="cb44-9"><a href="#cb44-9"></a>    <span class="co"># generar la variable 1</span></span>
<span id="cb44-10"><a href="#cb44-10"></a>    v1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb44-11"><a href="#cb44-11"></a></span>
<span id="cb44-12"><a href="#cb44-12"></a>    <span class="co"># generar la variable 2</span></span>
<span id="cb44-13"><a href="#cb44-13"></a>    v2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb44-14"><a href="#cb44-14"></a></span>
<span id="cb44-15"><a href="#cb44-15"></a>    <span class="co"># correr correlacion</span></span>
<span id="cb44-16"><a href="#cb44-16"></a>    corr_coef <span class="ot">&lt;-</span> <span class="fu">cor</span>(v1, v2)</span>
<span id="cb44-17"><a href="#cb44-17"></a></span>
<span id="cb44-18"><a href="#cb44-18"></a>    <span class="co"># guardar resultados</span></span>
<span id="cb44-19"><a href="#cb44-19"></a>    cc_vector[<span class="fu">length</span>(cc_vector) <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> corr_coef</span>
<span id="cb44-20"><a href="#cb44-20"></a></span>
<span id="cb44-21"><a href="#cb44-21"></a>}</span>
<span id="cb44-22"><a href="#cb44-22"></a></span>
<span id="cb44-23"><a href="#cb44-23"></a><span class="fu">head</span>(cc_vector)</span></code></pre></div>
<pre><code>## [1] -0.047693  0.232015  0.133767 -0.089900  0.364152  0.203306</code></pre>
<p> </p>
<p><img src="bucles_loops_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<hr />
<div class="alert alert-info">
<p><font size="5">Ejercicio 4</font></p>
<p>  4.1 Convierta en un bucle <code>while</code> el bucle
<code>repeat</code> del ejercicio 3.1</p>
<p> </p>
<p>4.2 Haga un bucle <code>while</code> que se detenga si la correlación
es superior a 0.8 o si el bucle ha estado ejecutándose durante más de 10
segundos (consejo: use la función<code>difftime</code> y / o
<code>as.numeric</code>)</p>
<p> </p>
<p>4.3 Haga un bucle <code>repeat</code> que se detenga solo si la
correlación es mayor que 0.5 pero menor que 0.55</p>
</div>
<hr />
<div id="referencias" class="section level2">
<h2>Referencias</h2>
<ul>
<li><a href="http://adv-r.had.co.nz/Functionals.html">Advanced R, H
Wickham</a></li>
<li><a
href="https://www.datacamp.com/community/tutorials/tutorial-on-loops-in-r">A
Tutorial on Loops in R - Usage and Alternatives, DataCamp</a></li>
</ul>
<hr />
<p><font size="5">Session information</font></p>
<pre><code>## R version 4.1.1 (2021-08-10)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.2 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0
## 
## locale:
##  [1] LC_CTYPE=es_ES.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=es_CR.UTF-8        LC_COLLATE=es_ES.UTF-8    
##  [5] LC_MONETARY=es_CR.UTF-8    LC_MESSAGES=es_ES.UTF-8   
##  [7] LC_PAPER=es_CR.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=es_CR.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] xaringanExtra_0.7.0 ggplot2_3.3.6       RColorBrewer_1.1-3 
## [4] kableExtra_1.3.4    knitr_1.39         
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_1.1.2  xfun_0.31         bslib_0.3.1       purrr_0.3.4      
##  [5] colorspace_2.0-3  vctrs_0.4.1       generics_0.1.2    htmltools_0.5.3  
##  [9] viridisLite_0.4.0 yaml_2.3.5        utf8_1.2.2        rlang_1.0.4      
## [13] jquerylib_0.1.4   pillar_1.8.0      glue_1.6.2        withr_2.5.0      
## [17] DBI_1.1.3         uuid_1.1-0        lifecycle_1.0.1   stringr_1.4.0    
## [21] munsell_0.5.0     gtable_0.3.0      rvest_1.0.2       evaluate_0.15    
## [25] labeling_0.4.2    fastmap_1.1.0     fansi_1.0.3       highr_0.9        
## [29] scales_1.2.0      formatR_1.12      webshot_0.5.3     jsonlite_1.8.0   
## [33] farver_2.1.1      systemfonts_1.0.4 digest_0.6.29     stringi_1.7.8    
## [37] dplyr_1.0.9       grid_4.1.1        cli_3.3.0         tools_4.1.1      
## [41] magrittr_2.0.3    sass_0.4.1        tibble_3.1.8      pkgconfig_2.0.3  
## [45] xml2_1.3.3        assertthat_0.2.1  rmarkdown_2.14    svglite_2.1.0    
## [49] httr_1.4.3        rstudioapi_0.13   R6_2.5.1          compiler_4.1.1</code></pre>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
