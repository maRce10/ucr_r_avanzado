<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>estadistica_tradicional_en_regresiones.knit</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/clipboard-2.0.6/clipboard.min.js"></script>
<link href="site_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.css" rel="stylesheet" />
<script src="site_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.js"></script>
<script>window.xaringanExtraClipboard(null, {"button":"<i class=\"fa fa-clipboard\"><\/i>","success":"<i class=\"fa fa-check\" style=\"color: #90BE6D\"><\/i>","error":"<i class=\"fa fa-times-circle\" style=\"color: #F94144\"><\/i>"})</script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="extra.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R avanzado</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Manuales
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="fundamentos_de_r.html">Fundamentos de R</a>
    </li>
    <li>
      <a href="reportes_dinamicos_con_rmarkdown.html">Reportes dinámicos con Rmarkdown</a>
    </li>
    <li>
      <a href="funciones.html">Funciones</a>
    </li>
    <li>
      <a href="modelos_de_regresion_lineal.html">Modelos de regresión lineal</a>
    </li>
    <li>
      <a href="stadistica_tradicional_en_regresiones.html">Modelos comunes como regresiones</a>
    </li>
    <li>
      <a href="graficos_con_ggplot2.html">Gráficos con ggplot2</a>
    </li>
  </ul>
</li>
<li>
  <a href="preparacion_curso.html">Preparación para el curso</a>
</li>
<li>
  <a href="https://codefile.io/f/XOIzH23KfULuZKyZ1TYT">Compartir código</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tareas
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Tarea 4</li>
    <li class="dropdown-header">Tarea 5</li>
  </ul>
</li>
<li>
  <a href="https://github.com/maRce10/ucr_r_avanzado/raw/master/additional_files/2022-08-05_Probl%20Esp%20Ecol_Estadistica%20Avanzada%20en%20R.pdf">Programa del curso</a>
</li>
<li>
  <a href="instructor.html">Instructor</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore"><center>
<font size="7"><b>Modelos estádisticos tradicionales como
regresiones</b></font>
</center></h1>
<h3 class="subtitle"><center>
<font size="4"><b>Programación y métodos estadísticos avanzados en R</b>
</font>
</center></h3>
<h4 class="author"><center>
<font size="3"><a href="http://marceloarayasalas.weebly.com/">Marcelo
Araya-Salas, PhD</a></font>
</center></h4>
<h4 class="date"><center>
“2022-09-25”
</center></h4>

</div>


<style>
body
  { counter-reset: source-line 0; }
pre.numberSource code
  { counter-reset: none; }
</style>
<p>Here we will walk through the most common statistical tests and show
how they can be represented in the linear regression format. This
section is based on <a
href="https://lindeloev.github.io/tests-as-linear/">this post</a>. Check
it out for a more in-depth description of the non-parametric
alternatives.</p>
<hr />
<div id="one-sample-t-test" class="section level1">
<h1>One sample t-test</h1>
<p>The test evaluates if the mean of a continuous variable is different
from 0. It is equivalent to a linear regression with no predictor, that
tests if the intercept is different from 0:</p>
<center>
<font size = 6><span class="math inline">\(y = \beta_0 \qquad
\mathcal{H}_0: \beta_0 = 0\)</span></font>
</center>
<p> </p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># number of observations</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># set seed</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co"># create variable with mean 1</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">1</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># run t test</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>(t <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y))</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  y
## t = 7.9, df = 49, p-value = 2.718e-10
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  0.7712742 1.2975329
## sample estimates:
## mean of x 
##  1.034404</code></pre>
<div class="sourceCode" id="cb3"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># run equivalent linear regression</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>(lm_t <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ 1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.0010 -0.5937 -0.1070  0.6638  2.1345 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   1.0344     0.1309     7.9 2.72e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9259 on 49 degrees of freedom</code></pre>
<p> </p>
<p>Let’s put the results from both tests together to compare them more
closely:</p>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
model
</th>
<th style="text-align:center;">
estimate
</th>
<th style="text-align:center;">
p.value
</th>
<th style="text-align:center;">
t
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
t-test
</td>
<td style="text-align:center;">
1.0344
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
7.9
</td>
</tr>
<tr>
<td style="text-align:center;">
lm
</td>
<td style="text-align:center;">
1.0344
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
7.9
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>Note that, as there are no predictor in the model, we used a ‘1’ in
the place for predictors in the model formula (‘y ~ 1’).</p>
<hr />
</div>
<div id="paired-t-test" class="section level1">
<h1>Paired t-test</h1>
<p>A paired t-test evaluates if the mean difference between two numeric
variables is 0:</p>
<center>
<font size = 6><span class="math inline">\(y1 - y2 = \beta_0 \qquad
\mathcal{H}_0: \beta_0 = 0\)</span></font>
</center>
<p> </p>
<p>The correspondent linear model is the same than that for the
one-sample t-test, but the input variable is the difference between the
two variables (y1 - y2):</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># sample size</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co"># variable with mean 1</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>y1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">1</span>)</span>
<span id="cb5-8"><a href="#cb5-8"></a></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co"># variable with mean 3</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>y2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="fl">1.4</span>)</span>
<span id="cb5-11"><a href="#cb5-11"></a></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co"># run paired t test</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>paired_t <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y1, y2, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-14"><a href="#cb5-14"></a></span>
<span id="cb5-15"><a href="#cb5-15"></a>paired_t</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  y1 and y2
## t = -2.7468, df = 49, p-value = 0.008395
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.8865856 -0.1374239
## sample estimates:
## mean of the differences 
##              -0.5120047</code></pre>
<div class="sourceCode" id="cb7"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># difference between the 2 variables</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>diff_y <span class="ot">&lt;-</span> y1 <span class="sc">-</span> y2</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># run model</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>lm_paired_t <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">formula =</span> diff_y <span class="sc">~</span> <span class="dv">1</span>))</span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a>lm_paired_t</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = diff_y ~ 1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.6003 -0.7010  0.1121  1.0348  2.9089 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)  -0.5120     0.1864  -2.747  0.00839 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.318 on 49 degrees of freedom</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
model
</th>
<th style="text-align:center;">
estimate
</th>
<th style="text-align:center;">
p.value
</th>
<th style="text-align:center;">
t
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
paired t-test
</td>
<td style="text-align:center;">
-0.512
</td>
<td style="text-align:center;">
0.0084
</td>
<td style="text-align:center;">
-2.7468
</td>
</tr>
<tr>
<td style="text-align:center;">
lm
</td>
<td style="text-align:center;">
-0.512
</td>
<td style="text-align:center;">
0.0084
</td>
<td style="text-align:center;">
-2.7468
</td>
</tr>
</tbody>
</table>
<p> </p>
<hr />
</div>
<div id="two-means-t-test" class="section level1">
<h1>Two means t-test</h1>
<p>Also called independent t-test. Evaluates if the means of the two
variables are different. The null hypothesis is that the difference is
0:</p>
<center>
<font size = 6><span class="math inline">\(y = \beta_0 + \beta_1 * x1
\qquad \mathcal{H}_0: \beta_1 = 0\)</span></font>
</center>
<div class="sourceCode" id="cb9"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># set seed</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co"># number of observations</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb9-9"><a href="#cb9-9"></a></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co"># random variables</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>x1_num <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb9-12"><a href="#cb9-12"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1_num <span class="sc">+</span> error</span>
<span id="cb9-13"><a href="#cb9-13"></a></span>
<span id="cb9-14"><a href="#cb9-14"></a>x1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(x1_num, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>))</span>
<span id="cb9-15"><a href="#cb9-15"></a></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co"># create data frame</span></span>
<span id="cb9-17"><a href="#cb9-17"></a>xy_data_cat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x1_num, y)</span>
<span id="cb9-18"><a href="#cb9-18"></a></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co"># run paired t test</span></span>
<span id="cb9-20"><a href="#cb9-20"></a>indep_t <span class="ot">&lt;-</span> <span class="fu">t.test</span>(xy_data_cat<span class="sc">$</span>y[xy_data_cat<span class="sc">$</span>x1 <span class="sc">==</span> <span class="st">&quot;a&quot;</span>], xy_data_cat<span class="sc">$</span>y[xy_data_cat<span class="sc">$</span>x1 <span class="sc">==</span></span>
<span id="cb9-21"><a href="#cb9-21"></a>    <span class="st">&quot;b&quot;</span>])</span>
<span id="cb9-22"><a href="#cb9-22"></a></span>
<span id="cb9-23"><a href="#cb9-23"></a>indep_t</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  xy_data_cat$y[xy_data_cat$x1 == &quot;a&quot;] and xy_data_cat$y[xy_data_cat$x1 == &quot;b&quot;]
## t = -12.276, df = 47.946, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -3.751804 -2.695745
## sample estimates:
##  mean of x  mean of y 
## -4.0774838 -0.8537091</code></pre>
<div class="sourceCode" id="cb11"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># run regression model</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>lm_indep_t <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_data_cat))</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a>lm_indep_t</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1, data = xy_data_cat)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.1129 -0.5939 -0.1355  0.5519  2.2464 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -4.0775     0.1857  -21.96   &lt;2e-16 ***
## x1b           3.2238     0.2626   12.28   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9285 on 48 degrees of freedom
## Multiple R-squared:  0.7584, Adjusted R-squared:  0.7534 
## F-statistic: 150.7 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
model
</th>
<th style="text-align:center;">
estimate
</th>
<th style="text-align:center;">
p.value
</th>
<th style="text-align:center;">
t
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
2 means t-test
</td>
<td style="text-align:center;">
3.2238
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
-12.2759
</td>
</tr>
<tr>
<td style="text-align:center;">
lm
</td>
<td style="text-align:center;">
3.2238
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
12.2759
</td>
</tr>
</tbody>
</table>
<p> </p>
<hr />
</div>
<div id="three-or-more-means-one-way-anova" class="section level1">
<h1>Three or more means: one-way ANOVA</h1>
<p>Very similar to the two means t-test but with three or more levels in
the categorical variable:</p>
<center>
<font size = 6><span class="math inline">\(\hat{Y} \sim \beta_{o} +
\beta_{1} * x_{1} + \beta_{2} * x_{2} + ... \qquad \mathcal{H}_0: y =
\beta_0\)</span></font>
</center>
<p> </p>
<p>So <strong>it is a multiple regression model</strong>. The
categorical variable is dummy coded so it gets split into indicator
predictors (<span class="math inline">\(x_i\)</span> is either <span
class="math inline">\(x=0\)</span> or <span
class="math inline">\(x=1\)</span>).</p>
<p>A data set with a 3-level categorical variable can be simulated like
this:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># set seed</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co"># number of observations</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb13-8"><a href="#cb13-8"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co"># random variables</span></span>
<span id="cb13-11"><a href="#cb13-11"></a>x1_num <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.33</span>, <span class="fl">0.33</span>))</span>
<span id="cb13-12"><a href="#cb13-12"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1_num <span class="sc">+</span> error</span>
<span id="cb13-13"><a href="#cb13-13"></a></span>
<span id="cb13-14"><a href="#cb13-14"></a>x1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(x1_num, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>))</span>
<span id="cb13-15"><a href="#cb13-15"></a></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="co"># create data frame</span></span>
<span id="cb13-17"><a href="#cb13-17"></a>xy_data_cat2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, y)</span>
<span id="cb13-18"><a href="#cb13-18"></a></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="fu">head</span>(xy_data_cat2)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
x1
</th>
<th style="text-align:center;">
y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
b
</td>
<td style="text-align:center;">
-1.5605
</td>
</tr>
<tr>
<td style="text-align:center;">
a
</td>
<td style="text-align:center;">
-4.2302
</td>
</tr>
<tr>
<td style="text-align:center;">
b
</td>
<td style="text-align:center;">
0.5587
</td>
</tr>
<tr>
<td style="text-align:center;">
c
</td>
<td style="text-align:center;">
2.0705
</td>
</tr>
<tr>
<td style="text-align:center;">
b
</td>
<td style="text-align:center;">
-0.8707
</td>
</tr>
<tr>
<td style="text-align:center;">
b
</td>
<td style="text-align:center;">
0.7151
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb14"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># ANOVA function</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>anv_1w <span class="ot">&lt;-</span> <span class="fu">anova</span>(<span class="fu">aov</span>(<span class="at">formula =</span> y1 <span class="sc">~</span> x1, <span class="at">data =</span> xy_data_cat2))</span>
<span id="cb14-3"><a href="#cb14-3"></a></span>
<span id="cb14-4"><a href="#cb14-4"></a>anv_1w</span></code></pre></div>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Df
</th>
<th style="text-align:center;">
Sum Sq
</th>
<th style="text-align:center;">
Mean Sq
</th>
<th style="text-align:center;">
F value
</th>
<th style="text-align:center;">
Pr(&gt;F)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
4.3728
</td>
<td style="text-align:center;">
2.1864
</td>
<td style="text-align:center;">
2.7307
</td>
<td style="text-align:center;">
0.0755
</td>
</tr>
<tr>
<td style="text-align:center;">
47
</td>
<td style="text-align:center;">
37.6318
</td>
<td style="text-align:center;">
0.8007
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb15"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># linear regression</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>lm_anv_1w <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">formula =</span> y1 <span class="sc">~</span> x1, <span class="at">data =</span> xy_data_cat2))</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a>lm_anv_1w</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y1 ~ x1, data = xy_data_cat2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.67208 -0.51953 -0.02887  0.48386  2.32657 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.8424     0.1866   4.515 4.24e-05 ***
## x1b           0.5646     0.2774   2.035   0.0475 *  
## x1c          -0.1409     0.3673  -0.384   0.7030    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8948 on 47 degrees of freedom
## Multiple R-squared:  0.1041, Adjusted R-squared:  0.06598 
## F-statistic: 2.731 on 2 and 47 DF,  p-value: 0.07552</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
model
</th>
<th style="text-align:center;">
F.statistic
</th>
<th style="text-align:center;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1 way anova
</td>
<td style="text-align:center;">
2.7307
</td>
<td style="text-align:center;">
0.0755
</td>
</tr>
<tr>
<td style="text-align:center;">
lm
</td>
<td style="text-align:center;">
2.7307
</td>
<td style="text-align:center;">
0.0755
</td>
</tr>
</tbody>
</table>
<p> </p>
<hr />
</div>
<div id="chi-square-for-contingency-tables" class="section level1">
<h1>Chi-square for contingency tables</h1>
<p>This test looks to find and association between two categorical
variables based on the co-occurrence of the categories, measured as
counts. This is what a contingency table is, counts for all combinations
of categories between two variables. For instance deaths by age of
passenger of the Titanic:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># Contingency table modified from</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co"># https://lindeloev.github.io/tests-as-linear/</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>mood_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">70</span>, <span class="dv">30</span>, <span class="dv">32</span>, <span class="dv">110</span>, <span class="dv">120</span>), <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb17-4"><a href="#cb17-4"></a>    <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="at">handedness =</span> <span class="fu">c</span>(<span class="st">&quot;left_handed&quot;</span>, <span class="st">&quot;right_handed&quot;</span>),</span>
<span id="cb17-5"><a href="#cb17-5"></a>        <span class="at">mood =</span> <span class="fu">c</span>(<span class="st">&quot;happy&quot;</span>, <span class="st">&quot;meh&quot;</span>, <span class="st">&quot;sad&quot;</span>)))</span>
<span id="cb17-6"><a href="#cb17-6"></a></span>
<span id="cb17-7"><a href="#cb17-7"></a>mood_data</span></code></pre></div>
<pre><code>##               mood
## handedness     happy meh sad
##   left_handed    100  30 110
##   right_handed    70  32 120</code></pre>
<p> </p>
<p>Although the coding is a bit more elaborated it can be narrow down to
log-linear two-way ANOVA model:</p>
<p><span class="math inline">\(log(y_i) = log(N) + log(\alpha_i) +
log(\beta_j) + log(\alpha_i\beta_j)\)</span></p>
<p> </p>
<p>The regression coefficients are <span
class="math inline">\(A_i\)</span> and <span
class="math inline">\(B_i\)</span>. <span
class="math inline">\(\alpha_i\)</span> and <span
class="math inline">\(\beta_j\)</span> are the proportions of counts for
the two levels of the binary categorical variable (one for each of the
levels in the second categorical variable). Fortunately, there is an
implementation of this model from the R package ‘MASS’ that simplifies
coding:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Built-in chi-square. It requires matrix format.</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>chi_mod <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(mood_data)</span>
<span id="cb19-3"><a href="#cb19-3"></a></span>
<span id="cb19-4"><a href="#cb19-4"></a>chi_mod</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  mood_data
## X-squared = 5.0999, df = 2, p-value = 0.07809</code></pre>
<div class="sourceCode" id="cb21"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># convert to long</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>mood_data_long <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(mood_data))</span>
<span id="cb21-3"><a href="#cb21-3"></a></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="co"># log linear model from MASS package</span></span>
<span id="cb21-5"><a href="#cb21-5"></a>log_lm_mod <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">loglm</span>(Freq <span class="sc">~</span> handedness <span class="sc">+</span> mood, <span class="at">data =</span> mood_data_long)</span>
<span id="cb21-6"><a href="#cb21-6"></a></span>
<span id="cb21-7"><a href="#cb21-7"></a>log_lm_mod</span></code></pre></div>
<pre><code>## Call:
## MASS::loglm(formula = Freq ~ handedness + mood, data = mood_data_long)
## 
## Statistics:
##                       X^2 df   P(&gt; X^2)
## Likelihood Ratio 5.119915  2 0.07730804
## Pearson          5.099859  2 0.07808717</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
model
</th>
<th style="text-align:center;">
X.squared
</th>
<th style="text-align:center;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
chi-square
</td>
<td style="text-align:center;">
5.0999
</td>
<td style="text-align:center;">
0.0781
</td>
</tr>
<tr>
<td style="text-align:center;">
log lm
</td>
<td style="text-align:center;">
5.0999
</td>
<td style="text-align:center;">
0.0781
</td>
</tr>
</tbody>
</table>
<p> </p>
</div>
<div id="non-parametric-alternatives-as-linear-regression-models"
class="section level1">
<h1>‘Non-parametric’ alternatives as linear regression models</h1>
<p>We will only feature one example of a ‘non-parametric’ test.
Nonetheless, this single example should be enough to demonstrate the
logic behind ‘non-parametric’ procedures. Most ‘non-parametric’ rely on
a simple data transformation trick: rank transforming responses. Rank
transformations converts values to an index according to their position
when sorted by magnitude:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># simulate variable</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb23-3"><a href="#cb23-3"></a>y <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>), <span class="dv">2</span>)</span>
<span id="cb23-4"><a href="#cb23-4"></a></span>
<span id="cb23-5"><a href="#cb23-5"></a>y</span></code></pre></div>
<pre><code>## [1] -0.56 -0.23  1.56  0.07  0.13</code></pre>
<div class="sourceCode" id="cb25"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># convert to ranks</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>rank_y <span class="ot">&lt;-</span> <span class="fu">rank</span>(y)</span>
<span id="cb25-3"><a href="#cb25-3"></a></span>
<span id="cb25-4"><a href="#cb25-4"></a>rank_y</span></code></pre></div>
<pre><code>## [1] 1 2 5 3 4</code></pre>
<p> </p>
<div id="wilcoxon-test-for-two-means" class="section level2">
<h2>Wilcoxon test for two means</h2>
<p>A.k.a Mann-Whitney test, is the non-parametric alternative to a
two-mean t test:</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># set seed</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb27-3"><a href="#cb27-3"></a></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="co"># number of observations</span></span>
<span id="cb27-5"><a href="#cb27-5"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb27-6"><a href="#cb27-6"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="fl">0.2</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb27-7"><a href="#cb27-7"></a></span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="co"># create data frame</span></span>
<span id="cb27-9"><a href="#cb27-9"></a>y_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y)</span>
<span id="cb27-10"><a href="#cb27-10"></a></span>
<span id="cb27-11"><a href="#cb27-11"></a></span>
<span id="cb27-12"><a href="#cb27-12"></a>y</span></code></pre></div>
<pre><code>##  [1] -0.360475647 -0.030177489  1.758708314  0.270508391  0.329287735
##  [6]  1.915064987  0.660916206 -1.065061235 -0.486852852 -0.245661970
## [11]  1.424081797  0.559813827  0.600771451  0.310682716 -0.355841135
## [16]  1.986913137  0.697850478 -1.766617157  0.901355902 -0.272791408
## [21] -0.867823706 -0.017974915 -0.826004448 -0.528891229 -0.425039268
## [26] -1.486693311  1.037787044  0.353373118 -0.938136937  1.453814921
## [31]  0.626464221 -0.095071483  1.095125661  1.078133488  1.021581082
## [36]  0.888640254  0.753917654  0.138088289 -0.105962664 -0.180471001
## [41] -0.494706979 -0.007917278 -1.065396352  2.368955965  1.407961998
## [46] -0.923108583 -0.202884835 -0.266655354  0.979965118  0.116630934</code></pre>
<div class="sourceCode" id="cb29"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># Wilcoxon / Mann-Whitney U</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>wilcx_mod <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(y_data<span class="sc">$</span>y)</span>
<span id="cb29-3"><a href="#cb29-3"></a></span>
<span id="cb29-4"><a href="#cb29-4"></a>wilcx_mod</span></code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank test with continuity correction
## 
## data:  y_data$y
## V = 797, p-value = 0.1248
## alternative hypothesis: true location is not equal to 0</code></pre>
<div class="sourceCode" id="cb31"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>signed_rank <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">sign</span>(x) <span class="sc">*</span> <span class="fu">rank</span>(<span class="fu">abs</span>(x))</span>
<span id="cb31-2"><a href="#cb31-2"></a></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="co"># As linear model with our dummy-coded group_y2:</span></span>
<span id="cb31-4"><a href="#cb31-4"></a>wicx_lm_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">signed_rank</span>(y) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> y_data)  <span class="co"># compare to </span></span>
<span id="cb31-5"><a href="#cb31-5"></a></span>
<span id="cb31-6"><a href="#cb31-6"></a><span class="fu">summary</span>(wicx_lm_mod)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = signed_rank(y) ~ 1, data = y_data)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -53.38 -24.13   0.12  25.37  43.62 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)    6.380      4.085   1.562    0.125
## 
## Residual standard error: 28.89 on 49 degrees of freedom</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
model
</th>
<th style="text-align:center;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1 mean wilcoxon
</td>
<td style="text-align:center;">
0.1248
</td>
</tr>
<tr>
<td style="text-align:center;">
wilcoxon_lm
</td>
<td style="text-align:center;">
0.1248
</td>
</tr>
</tbody>
</table>
<p> </p>
<hr />
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<ul>
<li><a href="https://lindeloev.github.io/tests-as-linear/">Common
statistical tests are linear models</a></li>
</ul>
<p> </p>
<hr />
<p> </p>
<p><font size="4">Session information</font></p>
<pre><code>## R version 4.1.1 (2021-08-10)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.2 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0
## 
## locale:
##  [1] LC_CTYPE=es_ES.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=es_CR.UTF-8        LC_COLLATE=es_ES.UTF-8    
##  [5] LC_MONETARY=es_CR.UTF-8    LC_MESSAGES=es_ES.UTF-8   
##  [7] LC_PAPER=es_CR.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=es_CR.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] viridis_0.6.2     viridisLite_0.4.0 ggplot2_3.3.6     knitr_1.39       
## [5] kableExtra_1.3.4 
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_1.1.2    xfun_0.31           bslib_0.3.1        
##  [4] purrr_0.3.4         colorspace_2.0-3    vctrs_0.4.1        
##  [7] generics_0.1.2      htmltools_0.5.3     yaml_2.3.5         
## [10] utf8_1.2.2          rlang_1.0.4         jquerylib_0.1.4    
## [13] pillar_1.8.0        glue_1.6.2          withr_2.5.0        
## [16] DBI_1.1.3           uuid_1.1-0          lifecycle_1.0.1    
## [19] stringr_1.4.0       munsell_0.5.0       gtable_0.3.0       
## [22] rvest_1.0.2         evaluate_0.15       fastmap_1.1.0      
## [25] fansi_1.0.3         highr_0.9           xaringanExtra_0.7.0
## [28] scales_1.2.0        formatR_1.12        webshot_0.5.3      
## [31] jsonlite_1.8.0      systemfonts_1.0.4   gridExtra_2.3      
## [34] digest_0.6.29       stringi_1.7.8       dplyr_1.0.9        
## [37] grid_4.1.1          cli_3.3.0           tools_4.1.1        
## [40] magrittr_2.0.3      sass_0.4.1          tibble_3.1.8       
## [43] pkgconfig_2.0.3     MASS_7.3-54         xml2_1.3.3         
## [46] assertthat_0.2.1    rmarkdown_2.14      svglite_2.1.0      
## [49] httr_1.4.3          rstudioapi_0.13     R6_2.5.1           
## [52] compiler_4.1.1</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
