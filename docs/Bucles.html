<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bucles.knit</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/clipboard-2.0.6/clipboard.min.js"></script>
<link href="site_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.css" rel="stylesheet" />
<script src="site_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.js"></script>
<script>window.xaringanExtraClipboard(null, {"button":"<i class=\"fa fa-clipboard\"><\/i>","success":"<i class=\"fa fa-check\" style=\"color: #90BE6D\"><\/i>","error":"<i class=\"fa fa-times-circle\" style=\"color: #F94144\"><\/i>"})</script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="extra.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R avanzado</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Manuales
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="fundamentos_de_r.html">Fundamentos de R</a>
    </li>
    <li>
      <a href="reportes_dinamicos_con_rmarkdown.html">Reportes dinámicos con Rmarkdown</a>
    </li>
    <li>
      <a href="funciones.html">Funciones</a>
    </li>
    <li>
      <a href="modelos_de_regresion_lineal.html">Modelos de regresión lineal</a>
    </li>
    <li>
      <a href="stadistica_tradicional_en_regresiones.html">Modelos comunes como regresiones</a>
    </li>
    <li>
      <a href="graficos_con_ggplot2.html">Gráficos con ggplot2</a>
    </li>
  </ul>
</li>
<li>
  <a href="preparacion_curso.html">Preparación para el curso</a>
</li>
<li>
  <a href="https://codefile.io/f/XOIzH23KfULuZKyZ1TYT">Compartir código</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tareas
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="tarea_4.html">Tarea 4</a>
    </li>
    <li class="dropdown-header">Tarea 5</li>
  </ul>
</li>
<li>
  <a href="https://github.com/maRce10/ucr_r_avanzado/raw/master/additional_files/2022-08-05_Probl%20Esp%20Ecol_Estadistica%20Avanzada%20en%20R.pdf">Programa del curso</a>
</li>
<li>
  <a href="instructor.html">Instructor</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore"><center>
<font size="7"><b>Bucles (loops)</b></font>
</center></h1>
<h3 class="subtitle"><center>
<font size="5"><b>Programación y métodos estadísticos avanzados en
R</b></font>
</center></h3>
<h4 class="author"><center>
<font size="5"><a href="http://marceloarayasalas.weebly.com/">Marcelo
Araya-Salas, PhD</a></font>
</center></h4>
<h4 class="date"><center>
“2022-09-27”
</center></h4>

</div>


<style>
body
  { counter-reset: source-line 0; }
pre.numberSource code
  { counter-reset: none; }
</style>
<!-- skyblue box -->
<div id="objetivo-del-manual" class="section level1 alert alert-info">
<h1>Objetivo del manual</h1>
<ul>
<li>Aprender a procesar de forma serial operaciones que deben repetirse
sobre diferentes objetos</li>
</ul>
</div>
<p> </p>
<div id="bucles-loops" class="section level2">
<h2>Bucles (loops)</h2>
<ul>
<li>Proceso automatizado de varios pasos organizado como secuencias de
acciones (p. Ej., procesos ‘por lotes’)</li>
<li>Se usa para acelerar los procedimientos en los que se aplica la
misma acción a muchos objetos (similares)</li>
<li>Crítico para la gestión de grandes bases de datos (‘big data’, y
buenas prácticas de programación)</li>
</ul>
<p>2 tipos básicos:</p>
<ol style="list-style-type: decimal">
<li>Ejecutar hasta que se cumpla una condición predefinida (bucles
<code>while</code> y<code>repeat</code>)</li>
</ol>
<p><img src="images/loops1.png" width="60%" style="display: block; margin: auto;" />
 </p>
<p><font size = "2"> * Modificado de <i> Tutorial de bucles Datacamp
</i> </font>  </p>
<ol start="2" style="list-style-type: decimal">
<li>Ejecutar para un número predefinido de iteraciones (es decir,
tiempos). 2 tipos:
<ol style="list-style-type: lower-alpha">
<li>Los resultados pueden ingresarse nuevamente en la siguiente
iteración (bucles <code>for</code>)</li>
<li>Los resultados de una interacción no pueden afectar a otras
iteraciones (<code>(X) aplica</code>)</li>
</ol></li>
</ol>
<p><img src="images/loops2.png" width="40%" /></p>
<p> </p>
<p><em>Nota: cuando el resultado de una iteración es completamente
independiente de otras iteraciones, la tarea podría ejecutarse en
paralelo. Hablaremos sobre computación paralela durante la clase de
“codigo eficiente”</em></p>
<p> </p>
</div>
<div id="bucles-while" class="section level2">
<h2>Bucles ‘While’</h2>
<p>Los bucles <code>while</code> aplican una acción (1 o más funciones)
en una secuencia de elementos hasta que se cumpla una condición. La
condición puede evaluar un resultado del propio ciclo o una entrada
externa:</p>
<p><img src="images/while.png" width="70%" /></p>
<p>El siguiente ciclo <code>while</code> se ejecuta hasta que la
correlación de las variables continuas generadas al azar es mayor que un
umbral:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># definir valor inicial</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>corr_coef <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># iniciar bucle</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="cf">while</span> (corr_coef <span class="sc">&lt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a>    <span class="co"># generar la variable 1</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>    v1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a>    <span class="co"># generar la variable 2</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>    v2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a>    <span class="co"># corrrer la correlacion</span></span>
<span id="cb1-14"><a href="#cb1-14"></a>    corr_coef <span class="ot">&lt;-</span> <span class="fu">cor</span>(v1, v2)</span>
<span id="cb1-15"><a href="#cb1-15"></a></span>
<span id="cb1-16"><a href="#cb1-16"></a>    <span class="co"># imprimir</span></span>
<span id="cb1-17"><a href="#cb1-17"></a>    <span class="fu">print</span>(corr_coef)</span>
<span id="cb1-18"><a href="#cb1-18"></a>}</span>
<span id="cb1-19"><a href="#cb1-19"></a></span>
<span id="cb1-20"><a href="#cb1-20"></a>corr_coef</span></code></pre></div>
<pre><code>##  [1]  0.0872575  0.3865472  0.1199017 -0.2902941  0.2413406 -0.1667497
##  [7]  0.1272541  0.0011283 -0.1344395 -0.0184824  0.5966901</code></pre>
<p> </p>
<p>Para guardar cada uno de los resultados hay 2 opciones:</p>
<ul>
<li>Usando la función <code>append</code></li>
<li>Agregar nuevos elementos a un vector usando indexación</li>
</ul>
<p>Usando <code>append</code>:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># definir valor inicial</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>corr_coef <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co"># crear vector vacio</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>cc_vector <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="cf">while</span> (corr_coef <span class="sc">&lt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a>    <span class="co"># generar la variable 1</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>    v1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb3-11"><a href="#cb3-11"></a></span>
<span id="cb3-12"><a href="#cb3-12"></a>    <span class="co"># generar la variable 2</span></span>
<span id="cb3-13"><a href="#cb3-13"></a>    v2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb3-14"><a href="#cb3-14"></a></span>
<span id="cb3-15"><a href="#cb3-15"></a>    <span class="co"># correr la correlacion</span></span>
<span id="cb3-16"><a href="#cb3-16"></a>    corr_coef <span class="ot">&lt;-</span> <span class="fu">cor</span>(v1, v2)</span>
<span id="cb3-17"><a href="#cb3-17"></a></span>
<span id="cb3-18"><a href="#cb3-18"></a>    <span class="co"># guardar resultado usando append</span></span>
<span id="cb3-19"><a href="#cb3-19"></a>    cc_vector <span class="ot">&lt;-</span> <span class="fu">append</span>(cc_vector, corr_coef)</span>
<span id="cb3-20"><a href="#cb3-20"></a></span>
<span id="cb3-21"><a href="#cb3-21"></a>}</span>
<span id="cb3-22"><a href="#cb3-22"></a></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="fu">head</span>(cc_vector)</span></code></pre></div>
<pre><code>## [1] -0.047693  0.232015  0.133767 -0.089900  0.364152  0.203306</code></pre>
<p> </p>
<p>Podemos graficar el resultado como el gráfico anterior así:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a>cc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y =</span> cc_vector, <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cc_vector))</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cc, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">col =</span> cols[<span class="dv">4</span>],</span>
<span id="cb5-6"><a href="#cb5-6"></a>    <span class="at">lwd =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">col =</span> cols[<span class="dv">8</span>], <span class="at">lwd =</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Iteraciones&quot;</span>,</span>
<span id="cb5-7"><a href="#cb5-7"></a>    <span class="at">y =</span> <span class="st">&quot;Correlación de pearson (r)&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">25</span>)</span></code></pre></div>
<p><img src="Bucles_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Usando indexación:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># definir valor inicial</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>corr_coef <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># crear vector vacio</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>cc_vector <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="cf">while</span> (corr_coef <span class="sc">&lt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb6-8"><a href="#cb6-8"></a></span>
<span id="cb6-9"><a href="#cb6-9"></a>    <span class="co"># generar la variable 1</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>    v1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb6-11"><a href="#cb6-11"></a></span>
<span id="cb6-12"><a href="#cb6-12"></a>    <span class="co"># generar la variable 2</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>    v2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb6-14"><a href="#cb6-14"></a></span>
<span id="cb6-15"><a href="#cb6-15"></a>    <span class="co"># correr correlacion</span></span>
<span id="cb6-16"><a href="#cb6-16"></a>    corr_coef <span class="ot">&lt;-</span> <span class="fu">cor</span>(v1, v2)</span>
<span id="cb6-17"><a href="#cb6-17"></a></span>
<span id="cb6-18"><a href="#cb6-18"></a>    <span class="co"># guardar vector</span></span>
<span id="cb6-19"><a href="#cb6-19"></a>    cc_vector[<span class="fu">length</span>(cc_vector) <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> corr_coef</span>
<span id="cb6-20"><a href="#cb6-20"></a></span>
<span id="cb6-21"><a href="#cb6-21"></a>}</span>
<span id="cb6-22"><a href="#cb6-22"></a></span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="fu">head</span>(cc_vector)</span></code></pre></div>
<pre><code>## [1]  0.239060  0.212589  0.392069  0.132913 -0.093418 -0.320691</code></pre>
<p> </p>
<p>Pero tenga en cuenta que <code>append</code> puede ser muy lento (no
recomendado)</p>
<p> </p>
<p>Con un pequeño ajuste, un bucle <code>while</code> también puede
evaluar varias condiciones a la vez. Por ejemplo, también podemos
incluir altos valores de correlación negativa:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># definir valor inicial</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>corr_coef <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># crear vector vacio</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>cc_vector <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb8-6"><a href="#cb8-6"></a></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="cf">while</span> (corr_coef <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">&amp;</span> corr_coef <span class="sc">&gt;</span> <span class="sc">-</span><span class="fl">0.5</span>) {</span>
<span id="cb8-8"><a href="#cb8-8"></a></span>
<span id="cb8-9"><a href="#cb8-9"></a>    <span class="co"># generar la variable 1</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>    v1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb8-11"><a href="#cb8-11"></a></span>
<span id="cb8-12"><a href="#cb8-12"></a>    <span class="co"># generar la variable 2</span></span>
<span id="cb8-13"><a href="#cb8-13"></a>    v2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb8-14"><a href="#cb8-14"></a></span>
<span id="cb8-15"><a href="#cb8-15"></a>    <span class="co"># correr correlacion</span></span>
<span id="cb8-16"><a href="#cb8-16"></a>    corr_coef <span class="ot">&lt;-</span> <span class="fu">cor</span>(v1, v2)</span>
<span id="cb8-17"><a href="#cb8-17"></a></span>
<span id="cb8-18"><a href="#cb8-18"></a>    <span class="co"># guardar resultados</span></span>
<span id="cb8-19"><a href="#cb8-19"></a>    cc_vector[<span class="fu">length</span>(cc_vector) <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> corr_coef</span>
<span id="cb8-20"><a href="#cb8-20"></a></span>
<span id="cb8-21"><a href="#cb8-21"></a>}</span>
<span id="cb8-22"><a href="#cb8-22"></a></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="fu">head</span>(cc_vector)</span></code></pre></div>
<pre><code>## [1]  0.323266 -0.153637 -0.049445  0.154694  0.191022 -0.168300</code></pre>
<p> </p>
<p><img src="Bucles_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<hr />
<div class="alert alert-info">
<p><font size="5">Ejercicio 1</font></p>
<p></br> 1.1 Haga un bucle <code>while</code> que se detenga solo si la
correlación es mayor que 0.5 pero menor que 0.55</p>
<p></br></p>
<p>1.2 Haga un bucle <code>while</code> que se detenga si la correlación
es superior a 0.8 o si el bucle ha estado ejecutándose durante más de 10
segundos (consejo: use la función<code>difftime</code> y / o
<code>as.numeric</code>)</p>
</div>
<hr />
</div>
<div id="bucles-repeat" class="section level2">
<h2>Bucles ‘repeat’</h2>
<p>Los bucles <code>repeat</code> también deben cumplir una condición
para detenerse. Muy parecido a los bucles <code>while</code>. Sin
embargo, se realiza para que la acción se ejecute al menos una vez,
independientemente de la evaluación de la condición</p>
<p style="text-align: center;">
<img src = "repeat.png" alt = "loop repeat" height = "600" width = "300">
</p>
<p> </p>
<p>El siguiente bucle <code>repeat</code> hace lo mismo que el
bucle<code>while</code> anterior:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># crear vector vacio</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>cc_vector <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="cf">repeat</span> {</span>
<span id="cb10-5"><a href="#cb10-5"></a>    <span class="co"># generar la variable 1</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>    v1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a>    <span class="co"># generar la variable 2</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>    v2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb10-10"><a href="#cb10-10"></a></span>
<span id="cb10-11"><a href="#cb10-11"></a>    <span class="co"># correr la correlacion</span></span>
<span id="cb10-12"><a href="#cb10-12"></a>    corr_coef <span class="ot">&lt;-</span> <span class="fu">cor</span>(v1, v2)</span>
<span id="cb10-13"><a href="#cb10-13"></a></span>
<span id="cb10-14"><a href="#cb10-14"></a>    <span class="co"># guardar resultados</span></span>
<span id="cb10-15"><a href="#cb10-15"></a>    cc_vector[<span class="fu">length</span>(cc_vector) <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> corr_coef</span>
<span id="cb10-16"><a href="#cb10-16"></a></span>
<span id="cb10-17"><a href="#cb10-17"></a>    <span class="co"># parar si se cumple la condicion</span></span>
<span id="cb10-18"><a href="#cb10-18"></a>    <span class="cf">if</span> (corr_coef <span class="sc">&gt;</span> <span class="fl">0.5</span>)</span>
<span id="cb10-19"><a href="#cb10-19"></a>        <span class="cf">break</span></span>
<span id="cb10-20"><a href="#cb10-20"></a></span>
<span id="cb10-21"><a href="#cb10-21"></a>}</span>
<span id="cb10-22"><a href="#cb10-22"></a></span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="fu">head</span>(cc_vector)</span></code></pre></div>
<pre><code>## [1]  0.2327630  0.2225129  0.3036371 -0.0098055  0.0495164 -0.1844224</code></pre>
<p> </p>
<p>Tenga en cuenta que en este caso la condición determina si el ciclo
debe detenerse. En el ciclo <code>while</code> la condición determina si
el ciclo debe continuar.</p>
<p> </p>
<div class="alert alert-info">
<p><font size = "5"> Ejercicio 2 </font></p>
<p></br></p>
<p>2.1 Convierta en un bucle <code>repeat</code> el bucle
<code>while</code> del ejercicio 1.2</p>
</div>
</div>
<div id="bucles-for" class="section level2">
<h2>Bucles ‘for’</h2>
<p>Por mucho, <code>for</code> es el bucle más popular. El número de
iteraciones se puede determinar de antemano:</p>
<p style="text-align: center;">
<img src = "for.png" alt = "for loop" height = "600" width = "300">
</p>
<p> </p>
<p>Nuevamente, creamos un bucle que calcula las correlaciones entre
variables aleatorias, en este caso usando un bucle <code>for</code>:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># crear un vector vacio</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>cc_vector <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-3"><a href="#cb12-3"></a></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co"># determinar numero de Iteraciones</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>reps <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb12-6"><a href="#cb12-6"></a></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co"># iniciar bucle</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>reps) {</span>
<span id="cb12-9"><a href="#cb12-9"></a>    <span class="co"># generar la variable 1</span></span>
<span id="cb12-10"><a href="#cb12-10"></a>    v1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb12-11"><a href="#cb12-11"></a></span>
<span id="cb12-12"><a href="#cb12-12"></a>    <span class="co"># generar la variable 2</span></span>
<span id="cb12-13"><a href="#cb12-13"></a>    v2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb12-14"><a href="#cb12-14"></a></span>
<span id="cb12-15"><a href="#cb12-15"></a>    <span class="co"># correr la correlacion</span></span>
<span id="cb12-16"><a href="#cb12-16"></a>    corr_coef <span class="ot">&lt;-</span> <span class="fu">cor</span>(v1, v2)</span>
<span id="cb12-17"><a href="#cb12-17"></a></span>
<span id="cb12-18"><a href="#cb12-18"></a>    <span class="co"># guardar resultados</span></span>
<span id="cb12-19"><a href="#cb12-19"></a>    cc_vector[<span class="fu">length</span>(cc_vector) <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> corr_coef</span>
<span id="cb12-20"><a href="#cb12-20"></a></span>
<span id="cb12-21"><a href="#cb12-21"></a>}</span></code></pre></div>
<p><img src="Bucles_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Una característica importante de los bucles
<code>while</code>,<code>repeat</code> y <code>for</code> es que pueden
tomar resultados de iteraciones anteriores como entrada en iteraciones
posteriores. Esto se debe a que los objetos creados dentro de la función
se guardan en el entorno actual (a diferencia de los bucles
<code>Xapply</code>).</p>
<p>La utilidad de los bucles <code>for</code> para el manejo de datos se
entiende mejor cuando se aplica a conjuntos de datos. En este ejemplo
examinamos algunos juegos de datos de ejemplo en <code>R</code>. El
siguiente código crea una lista con 4 juegos de datos de ejemplo:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># lista con bases de datos</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>lista_datos <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">BOD =</span> BOD, <span class="at">CO2 =</span> CO2, <span class="at">ChickWeight =</span> ChickWeight,</span>
<span id="cb13-3"><a href="#cb13-3"></a>    <span class="at">DNase =</span> DNase)</span></code></pre></div>
<p> </p>
<p>La utilidad del bucle <code>for</code> es mas obvia y su lógica mas
fácil de entender si lo comparamos con cálculos equivalentes fuera de un
bucle. Por ejemplo, si quisiéramos un vector con el número de columnas
en cada uno de los elementos de <code>lista_datos</code>. Para hacer
esto sin un bucle necesitamos hacer el cálculo independientemente para
cada elemento:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># primer elemento</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>elm_1 <span class="ot">&lt;-</span> lista_datos[[<span class="dv">1</span>]]</span>
<span id="cb14-3"><a href="#cb14-3"></a>columnas_1 <span class="ot">&lt;-</span> <span class="fu">ncol</span>(elm_1)</span>
<span id="cb14-4"><a href="#cb14-4"></a></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co"># segundo elemento</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>elm_2 <span class="ot">&lt;-</span> lista_datos[[<span class="dv">2</span>]]</span>
<span id="cb14-7"><a href="#cb14-7"></a>columnas_2 <span class="ot">&lt;-</span> <span class="fu">ncol</span>(elm_2)</span>
<span id="cb14-8"><a href="#cb14-8"></a></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co"># tercer elemento</span></span>
<span id="cb14-10"><a href="#cb14-10"></a>elm_3 <span class="ot">&lt;-</span> lista_datos[[<span class="dv">3</span>]]</span>
<span id="cb14-11"><a href="#cb14-11"></a>columnas_3 <span class="ot">&lt;-</span> <span class="fu">ncol</span>(elm_3)</span>
<span id="cb14-12"><a href="#cb14-12"></a></span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="co"># cuarto elemento</span></span>
<span id="cb14-14"><a href="#cb14-14"></a>elm_4 <span class="ot">&lt;-</span> lista_datos[[<span class="dv">4</span>]]</span>
<span id="cb14-15"><a href="#cb14-15"></a>columnas_4 <span class="ot">&lt;-</span> <span class="fu">ncol</span>(elm_4)</span>
<span id="cb14-16"><a href="#cb14-16"></a></span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="co"># poner valores en vector</span></span>
<span id="cb14-18"><a href="#cb14-18"></a>columnas <span class="ot">&lt;-</span> <span class="fu">c</span>(columnas_1, columnas_2, columnas_3, columnas_4)</span>
<span id="cb14-19"><a href="#cb14-19"></a></span>
<span id="cb14-20"><a href="#cb14-20"></a><span class="co"># ver resultado</span></span>
<span id="cb14-21"><a href="#cb14-21"></a>columnas</span></code></pre></div>
<pre><code>## [1] 2 5 4 3</code></pre>
<p>Esta repetición de tareas se puede simplificar con un bucle
<code>for</code> de la siguiente forma:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># crear vector vació para guardar resultados</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>columnas <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb16-3"><a href="#cb16-3"></a></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co"># correr bucle</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lista_datos)) {</span>
<span id="cb16-6"><a href="#cb16-6"></a></span>
<span id="cb16-7"><a href="#cb16-7"></a>    <span class="co"># sacar datos</span></span>
<span id="cb16-8"><a href="#cb16-8"></a>    elm_i <span class="ot">&lt;-</span> lista_datos[[i]]</span>
<span id="cb16-9"><a href="#cb16-9"></a></span>
<span id="cb16-10"><a href="#cb16-10"></a>    <span class="co"># calcular numero de columnas</span></span>
<span id="cb16-11"><a href="#cb16-11"></a>    columnas_i <span class="ot">&lt;-</span> <span class="fu">ncol</span>(elm_i)</span>
<span id="cb16-12"><a href="#cb16-12"></a></span>
<span id="cb16-13"><a href="#cb16-13"></a>    <span class="co"># guardar valores</span></span>
<span id="cb16-14"><a href="#cb16-14"></a>    columnas <span class="ot">&lt;-</span> <span class="fu">append</span>(columnas, columnas_i)</span>
<span id="cb16-15"><a href="#cb16-15"></a>}</span></code></pre></div>
<p>Note que los valores del vector <code>1:length(lista_datos)</code> en
el llamado de <code>for</code> son tomados, uno a la vez, para hacer los
cálculos en el cuerpo del bucle.</p>
<div class="alert alert-info">
<p><font size = "5"> Ejercicio 3 </font></p>
<p></br></p>
<p>3.1 Haga un bucle <code>for</code> que devuelva el número de filas
para cada juego de datos de ejemplo</p>
<p></br></p>
<p>3.2 Haga un bucle <code>for</code> que devuelva el número de filas y
columnas para cada juego de datos de ejemplo</p>
<p></br></p>
<p>3.3 El juego de datos de ejemplo “ChickWeight” describe el “peso
versus la edad de los pollitos en diferentes dietas”:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># convertir a un data.frame</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>ChickWeight <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ChickWeight, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co"># ver las primeras filas</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="fu">head</span>(ChickWeight)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 18px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
weight
</th>
<th style="text-align:right;">
Time
</th>
<th style="text-align:left;">
Chick
</th>
<th style="text-align:left;">
Diet
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
76
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
93
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb18"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># ver estructura</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="fu">str</span>(ChickWeight)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    578 obs. of  4 variables:
##  $ weight: num  42 51 59 64 76 93 106 125 149 171 ...
##  $ Time  : num  0 2 4 6 8 10 12 14 16 18 ...
##  $ Chick : Ord.factor w/ 50 levels &quot;18&quot;&lt;&quot;16&quot;&lt;&quot;15&quot;&lt;..: 15 15 15 15 15 15 15 15 15 15 ...
##  $ Diet  : Factor w/ 4 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<p></br></p>
<p>Usando los datos de ChickWeight, calcule la correlación entre el peso
y la edad de cada pollito (consejo: (1) use
<code>unique (ChickWeight $ Chick)</code> dentro del inicio del bucle
<code>for</code> y (2) cree subconjuntos usando indexación dentro del
cuerpo del bucle)</p>
</div>
<p> </p>
</div>
<div id="bucles-xapply" class="section level2">
<h2>Bucles (X)apply</h2>
<p><code>(X) apply</code> son funciones de nivel superior que toman una
función como entrada y la aplican a una secuencia de objetos (vectores
<em>sensu lato</em>). Bucles creados con <code>(X)apply</code>. Hay
varias funciones <code>(X)apply</code> en R:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">apropos</span>(<span class="st">&quot;apply$&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;apply&quot;      &quot;dendrapply&quot; &quot;eapply&quot;     &quot;kernapply&quot;  &quot;lapply&quot;    
##  [6] &quot;mapply&quot;     &quot;rapply&quot;     &quot;sapply&quot;     &quot;tapply&quot;     &quot;vapply&quot;</code></pre>
<p> </p>
<p>Sin embargo, los más utilizados son
<code>apply</code>,<code>sapply</code>, <code>lapply</code>
y<code>tapply</code>. Todos siguen la misma lógica:</p>
<p style="text-align:center;">
<img src = "xapply.png" alt = "apply repeat" height = "500" width = "300">
</p>
<p> </p>
<p><code>lapply</code> toma un vector (atómico o de lista), aplica una
función a cada elemento y devuelve una lista:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">lapply</span>(<span class="at">X =</span> lista_datos, <span class="at">FUN =</span> nrow)</span></code></pre></div>
<pre><code>## $BOD
## [1] 6
## 
## $CO2
## [1] 84
## 
## $ChickWeight
## [1] 578
## 
## $DNase
## [1] 176</code></pre>
<p> </p>
<p><code>sapply</code> también toma un vector (atómico o de lista) y
aplica la función a cada elemento, sin embargo, el resultado es un
vector atómico (si puede empaquetarse como un vector):</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">sapply</span>(<span class="at">X =</span> lista_datos, <span class="at">FUN =</span> nrow)</span></code></pre></div>
<pre><code>##         BOD         CO2 ChickWeight       DNase 
##           6          84         578         176</code></pre>
<p> </p>
<p><code>apply</code> aplica una función a cada una de las filas o
columnas de un objeto bidimensional:</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">head</span>(iris, <span class="dv">4</span>)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 18px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
Sepal.Length
</th>
<th style="text-align:right;">
Sepal.Width
</th>
<th style="text-align:right;">
Petal.Length
</th>
<th style="text-align:right;">
Petal.Width
</th>
<th style="text-align:left;">
Species
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
5.1
</td>
<td style="text-align:right;">
3.5
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.9
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
3.1
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb27"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">apply</span>(<span class="at">X =</span> iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>], <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> sum)</span></code></pre></div>
<pre><code>##    1    2    3    4    5    6    7    8    9   10 
## 10.2  9.5  9.4  9.4 10.2 11.4  9.7 10.1  8.9  9.6</code></pre>
<div class="sourceCode" id="cb29"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">apply</span>(<span class="at">X =</span> iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>], <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> mean)</span></code></pre></div>
<pre><code>##     1     2     3     4     5     6     7     8     9    10 
## 2.550 2.375 2.350 2.350 2.550 2.850 2.425 2.525 2.225 2.400</code></pre>
<div class="sourceCode" id="cb31"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">apply</span>(<span class="at">X =</span> iris, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> class)</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species 
##  &quot;character&quot;  &quot;character&quot;  &quot;character&quot;  &quot;character&quot;  &quot;character&quot;</code></pre>
<p> </p>
<p><code>tapply</code> es más específico ya que aplica una función a un
subconjunto de datos definido por un vector categórico adicional. Por
ejemplo, podemos calcular la longitud promedio de pétalo para cada
especie en el juego de datos ‘iris’ de la siguiente manera:</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">tapply</span>(<span class="at">X =</span> iris<span class="sc">$</span>Petal.Length, <span class="at">INDEX =</span> iris<span class="sc">$</span>Species, <span class="at">FUN =</span> mean)</span></code></pre></div>
<pre><code>##     setosa versicolor  virginica 
##      1.462      4.260      5.552</code></pre>
<p> </p>
<p>Los bucles <code>(X) apply</code> pueden modificarse para realizar
“acciones” personalizadas creando nuevas funciones (ya sea dentro o
fuera del bucle):</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># funcion desde fuera del bucle</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>dims <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="fu">nrow</span>(x), <span class="fu">ncol</span>(x))</span>
<span id="cb35-3"><a href="#cb35-3"></a></span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="co"># correr buble</span></span>
<span id="cb35-5"><a href="#cb35-5"></a>df_dims <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="at">X =</span> lista_datos, <span class="at">FUN =</span> dims)</span>
<span id="cb35-6"><a href="#cb35-6"></a></span>
<span id="cb35-7"><a href="#cb35-7"></a><span class="co"># ver resultados</span></span>
<span id="cb35-8"><a href="#cb35-8"></a><span class="fu">head</span>(df_dims, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## $BOD
## [1] 6 2
## 
## $CO2
## [1] 84  5
## 
## $ChickWeight
## [1] 578   4</code></pre>
<div class="sourceCode" id="cb37"><pre
class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># # funcion dentro del bucle</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>df_dims <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="at">X =</span> lista_datos, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="fu">nrow</span>(x), <span class="fu">ncol</span>(x)))</span>
<span id="cb37-3"><a href="#cb37-3"></a></span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="co"># ver resultados</span></span>
<span id="cb37-5"><a href="#cb37-5"></a><span class="fu">head</span>(df_dims, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## $BOD
## [1] 6 2
## 
## $CO2
## [1] 84  5
## 
## $ChickWeight
## [1] 578   4</code></pre>
<p> </p>
<p>Tenga en cuenta que:</p>
<ol style="list-style-type: decimal">
<li><p>en este tipo de bucles no hay retroalimentación de las
iteraciones anteriores (es decir, los resultados de una iteración no se
pueden ingresar en las iteraciones posteriores)</p></li>
<li><p><code>(X)apply</code> es más limpio que otros bucles porque los
objetos creados dentro de ellos no están disponibles en el entorno de
trabajo actual.</p></li>
</ol>
<div class="alert alert-info">
<p><font size = "5"> Ejercicio 4 </font></p>
<p></br></p>
<p>4.1 Haga un bucle <code>lapply</code> equivalente al bucle
<code>for</code> en el ejercicio 3.4 (<em>utilizando los datos
‘ChickWeight’ calcule la correlación entre peso y tiempo para cada
Chick</em>)</p>
<p></br></p>
<p>4.2 Haga un bucle <code>sapply</code> para calcular el mayor peso
registrado para cada tipo de dieta (pista:
<code>unique(ChickWeight$Diet)</code>, deberia devolver un valor por
tipo de dieta). Nombre el vector resultante para que contenga el
identificador de cada dieta.</p>
<p></br></p>
<p>4.3 Haga un bucle <code>apply</code> para calcular la media de cada
variable numérica en el juego de datos ‘iris’.</p>
</div>
<div class="alert alert-info">
<p><font size = "5"> Ejercicios extra </font></p>
<p></br></p>
<p>E.1 Reúna los resultados del ejercicio 3.4 en un nuevo juego de datos
con columnas para ‘chick’ y ‘correlation’ usando un bucle
<code>for</code> (consejo: use <code>rbind</code>)</p>
<p></br></p>
<p>E.2 ¿Cuántos de los juego de datos de ejemplo en
<code>lista_datos</code> contienen una columna que es un factor?</p>
<p></br></p>
<p>E.3 Calcule el coeficiente de variación de cada variable numérica por
especie en el juego de datos ‘iris’ usando ‘tapply’.</p>
</div>
<hr />
</div>
<div id="referencias" class="section level2">
<h2>Referencias</h2>
<ul>
<li><a href="http://adv-r.had.co.nz/Functionals.html">Advanced R, H
Wickham</a></li>
<li><a
href="https://www.datacamp.com/community/tutorials/tutorial-on-loops-in-r">A
Tutorial on Loops in R - Usage and Alternatives, DataCamp</a></li>
</ul>
<hr />
<p><font size="5">Session information</font></p>
<pre><code>## R version 4.2.0 (2022-04-22)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 22.04.1 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=es_CR.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=es_CR.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=es_CR.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=es_CR.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] xaringanExtra_0.7.0 ggplot2_3.3.6       RColorBrewer_1.1-3 
## [4] kableExtra_1.3.4    knitr_1.40         
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_1.1.2  xfun_0.33         bslib_0.3.1       purrr_0.3.4      
##  [5] colorspace_2.0-3  vctrs_0.4.1       generics_0.1.2    htmltools_0.5.3  
##  [9] viridisLite_0.4.0 yaml_2.3.5        utf8_1.2.2        rlang_1.0.4      
## [13] jquerylib_0.1.4   pillar_1.8.0      glue_1.6.2        withr_2.5.0      
## [17] DBI_1.1.2         uuid_1.1-0        lifecycle_1.0.1   stringr_1.4.0    
## [21] munsell_0.5.0     gtable_0.3.0      rvest_1.0.2       evaluate_0.16    
## [25] labeling_0.4.2    fastmap_1.1.0     fansi_1.0.3       highr_0.9        
## [29] scales_1.2.0      formatR_1.12      webshot_0.5.3     jsonlite_1.8.0   
## [33] farver_2.1.1      systemfonts_1.0.4 digest_0.6.29     stringi_1.7.8    
## [37] dplyr_1.0.9       grid_4.2.0        cli_3.3.0         tools_4.2.0      
## [41] magrittr_2.0.3    sass_0.4.1        tibble_3.1.8      pkgconfig_2.0.3  
## [45] xml2_1.3.3        assertthat_0.2.1  rmarkdown_2.16    svglite_2.1.0    
## [49] httr_1.4.4        rstudioapi_0.13   R6_2.5.1          compiler_4.2.0</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
